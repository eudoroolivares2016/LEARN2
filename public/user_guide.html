<!doctype html>
<html class="no-js" lang="">

<head>
    <meta charset="utf-8">
    <title>LEARN&sup2;</title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <meta property="og:title" content="">
    <meta property="og:type" content="">
    <meta property="og:url" content="">
    <meta property="og:image" content="">

    <link rel="apple-touch-icon" href="resources/logo.png">
    <link rel="icon" href="resources/logo.png">
    <link rel="stylesheet" href="css/bootstrap.css">
    <link rel="stylesheet" href="css/style.css">
    <meta name="theme-color" content="#fafafa">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script src="https://sdk.amazonaws.com/js/aws-sdk-2.179.0.min.js"></script>


</head>

<body>
    <div class="page-body" id="page-body-id">
        <div class="user-guide-section">
            <div class="container-fluid main-header" id="main-header-id">
                <div class="learn2-logo">
                    <img src="resources/logo.png" class="img-fluid" style="width: 200px" alt="Responsive image">
                    LEARN&sup2;
                </div>
                <h3 class="learn2">Landfalling Event Atmospheric River Neural Network</h3>
            </div>
        <a href="#" id="toTopBtn" class="cd-top text-replace js-cd-top cd-top--is-visible cd-top--fade-out" data-abc="true"></a>
        
       
            
                <!-- <div style="text-align: center; padding-top: 20px;">
                <a href='/' style="width:100%"><div class="btn btn-lg btn-primary button-home" id="button-home-id">Home</div></a>
            
            </div> -->
           
            <div class="container-fluid user-guide-title">
                User Guide
            
            </div>
            <!-- <div class="container-fluid user-guide-control-panel">
                <div class="row">
                    <div class="col-sm-3 user-guide-left">
                        Initialization:
                    </div>
                    <div class="col-sm-9 user-guide-right">
                        The initialization date determines the date on which the forecast model was run. (i.e. 2022 Sept 15 (00Z) means the forecast was generated on that date at 00:00 GMT)
                    </div>
                </div>
                <br>
                <div class="row">
                    <div class="col-sm-3 user-guide-left">
                        Forecast Day:
                    </div>
                    <div class="col-sm-9 user-guide-right">
                        The initialization date determines the date on which the forecast model was run. (i.e. 2022 Sept 15 (00Z) means the forecast was generated on that date at 00:00 GMT)
                    </div>
                </div>
                <br>
                <div class="row">
                    <div class="col-sm-3 user-guide-left">
                        Model:
                    </div>
                    <div class="col-sm-9 user-guide-right">
                        The Model options can be selected to change the algorithm used for calculating the Forecasts (Voting, Convolutional, Dense, ECMWF GEFS).
                    </div>
                </div>
                <br>
                <div class="row">
                    <div class="col-sm-3 user-guide-left">
                        Threshold:
                    </div>
                    <div class="col-sm-9 user-guide-right">
                        TBD
                    </div>
                </div>
                <br>
                <div class="row">
                    <div class="col-sm-3 user-guide-left">
                        Resolution:
                    </div>
                    <div class="col-sm-9 user-guide-right">
                        The Resolution option determines the granularity of the Forecast and Daily Rainfall Threshold maps.
                    </div>
                </div>
                <br>
            </div> -->
<div class="container-fluid user-guide-control-panel">
            <div class="row user-guide-content">
              
                <div class="col-sm-9 user-guide-right">

                    <h2>Table of Contents</h2>
                    <hr>
                    <ol>
                        <li><a class='content-links' href='#purpose'>Purpose</a></li>
                        <li><a class='content-links' href='#intended-audience'>Intended Audience</a></li>
                        <li><a class='content-links' href='#scope'>Scope</a></li>
                        <li>
                            <ul style="list-style: none;"><b>Learn2 Functional Guide</b>
                            <li><i>i.</i> Overall Systems Architecture Description</li>
                            <li><i>ii.</i> Using Graphical User Interface (GUI)</li>
                        <li><i>iii.</i> Interacting with the Control Panel</li>
                        </ul>
                        </li>
                        <li><a class='content-links' href='#troubleshooting'>Troubleshooting</a></li>
                        <li><a class='content-links' href='#faq'>FAQ</a></li>
                        
                        
                    </ol>
                    <br>
                    <br>
                    <br>
                    <h2 id="purpose">Purpose</h2>
                    <hr>
                  <p>Atmospheric rivers are the main phenomena driving extreme rain events in the western United States during the rainy
                season (October-April). Their impacts are near the top of episodic weather events in the West. Accurately forecasting
                rainfall from these events is critical due to the impacts they have on the water supply as well as the severe flooding
                risks they pose. The greatest challenge of mitigating the associated impacts is reducing uncertainty in the medium-range
                forecasts (5-10 days). This is because the most critical decisions are made in this window, from water management in
                reservoir pool reduction to early flood risk communication and preparation. As such, any tool that both reduces
                uncertainty and pushes higher confidence to longer lead times is especially valuable. Forecasters are continually
                looking for insights that might support these critical decisions and another tool in the toolbox could be particularly
                beneficial, especially if, indeed, equivalent forecast skill is pushed out an additional 1 to 2 days.</p>
                <br>
            <p>The Landfalling Event Atmospheric River Neural Network (LEARN2) is a neural-network-based decision support tool that
            considers Numerical Weather Prediction (NWP) forecast guidance from NOAA/National Centers for Environmental Prediction
            (NCEP’s) Global Ensemble Forecast System (GEFS) and the European Center for Medium-Range Weather Forecasting Ensembles
            (ECMWF), remotely sensed fields, and several subseasonal-to-seasonal teleconnection indices, to produce extreme rainfall
            predictions. In LEARN2, products are run through both convolutional and fully connected neural networks and a novel
            “voting” algorithm that leverages the power of ensemble forecast systems to predict whether rainfall will exceed
            thresholds of interest at discrete points in a grid for lookaheads of up to 10 days. The structure of each neural
            network is determined for each forecast day via custom genetic algorithms to optimize LEARN2 performance.</p>
<br>
            <p>Rainfall prediction is known to be a difficult problem. One difficulty is that it rains far less frequently than it
            doesn’t rain. Though performing a cube root on the rainfall begins to address this problem, it remains the case that the
            dataset is highly unbalanced. Therefore, simple metrics like accuracy of prediction can distort the reported efficacy of
            the system. To evaluate the LEARN2 system more fairly and compare it against state-of-the-art NWP models, we use the
            commonly used F1-score. This score attempts to balance “recall” in which the system can correctly identify all positive
            cases with “precision” in which the system attempts to avoid “false alarms.” The neural networks are tested and trained
            on 20 years of historical data, split randomly into 80% training and 20% testing data. These splits are performed
            multiple times and the F1-score determined on each split to achieve a statistically stable average F1-score for the
            classification behavior of the neural networks.</p>
<br>
            <p>LEARN2 is trained on Open Data, including the operational Global Ensemble Forecast System (GEFSv12 with 5 ensemble
            members) and ECMWF’s (11 ensemble members) reforecasts spanning 2000-2019, using an Amazon Web Services machine with 48
            CPUs, 196 GB RAM, 50Gb/s network bandwidth, and 4 NVIDIA Tesla T4 GPUs. LEARN2 is evaluated against the Parameter
            elevation Regression on Independent Slopes Model (PRISM) gridded precipitation ground truth dataset. This project's
            results are, in fact, highly promising in delivering additional value in this most critical window. Not surprisingly,
            the development work has been particularly challenging and has required creative and exhaustive
            <br>
            exploration of the associated forecast space including a variety of input models, AI/ML tools, and model configurations.
            Using F1-score as our primary metric, LEARN2’s overall network produces predictions that significantly outperform both
            the GEFS and ECMWF, delivering between one and two additional days of lead time for skillful extreme rainfall prediction
            when validated on fully independent data (see the below figures). Notably, adding the Pacific/North American (PNA),
            Arctic Oscillation (AO), North Atlantic Oscillation (NAO), and El Niño/Southern Oscillation (ENSO) teleconnection
            indices introduces additional and complementary forecast-day-dependent predictive skill to the NWP model forecasts.</p>
<br>
            <p>Over the next several months, we will be operationally evaluating this tool using near-real-time NWP forecast model
            ensemble members — both NCEP GEFS and ECMWF (the latter via Open Data Creative Commons CC-4.0-BY license and ECMWF Terms
            of Use).</p>
<br>
            <p>This project was funded by the NOAA Office of Oceanic and Atmospheric Research (OAR) under the Small Business Innovative
            Research (SBIR) program.</p>
    <div class="row">
            <div class="col-md-6">  
            <img src="resources/Userguide-example-1..png">
        </div>
         <div class="col-md-6">
            <img src="resources/Userguide-example-2.png">
         </div>
         </div>  
         <br>
         <br>
        <h2 id="intended-audience">Intended Audience</h2>
        <hr>
        <p>The Landfalling Event Atmospheric River Neural Network (LEARN2) forecast tool was developed to provided decision
            makers,
            including operational meteorologists and hydrologists, with high-confidence predictions of extreme precipitation
            events,
            enabling strategic planning and tactical mitigations in advance of landfall. While this tool was developed with
            atmospheric-river events in mind, the training is generalized for the west-coastal-state domain for all
            precipitation
            events, not solely those directly associated with atmospheric rivers.</p>

            <br>
            <br>
            <h2 id="scope">Scope</h2>
            <hr>
            <p>This version of the Users’ Guide describes the LEARN2 tool and how to interact with it to achieve near-real-time
            forecasts of potential rain events in the western United States for “look-aheads” of 1-10 days.</p>
            
            <p>It does not describe how to maintain the two neural networks and genetic algorithm that are collectively the fundamental
            basis for the tool—this may be provided in a future version</p>
            
            <br>
            <br>
            <h2 id="architecture">Overall Systems Architecture</h2>
            <hr>
            <img src="/resources/Systems-arch-description.png">

            <br>
            <br>
            <h2 id="gui">Using the Graphical Interface</h2>
            <hr>
            <img src="/resources/gui.png">

            <br>
            <br>
            <h2 id="control-panel">Control Panel</h2>
            <hr>
            <img src="/resources/control-panel.png">


            <br>
            <br>
            <h2 id="troubleshooting">Troubleshooting</h2>
            <hr>
            <p>TBD</p>

            <br>
            <br>
            <h2 id="faq">FAQ</h2>
            <hr>
            <h3><b style="color:#e0f42b">What is the general description of this tool?</b></h3>
            <p>Predictions made by the LEARN2 system are the result of postprocessing and recombining ECMWF forecasts, GEFS forecasts,
            and subseasonal-to-seasonal teleconnection indices using a neural network specifically trained to identify rainfall
            events exceeding defined thresholds of interest. The neural network is tested and trained on 20 years of historical
            data, split randomly into 80% training and 20% testing data. These splits are performed multiple times and the F1-score
            (calculated as described below) on each split to achieve a statistically stable average F1-score for the classification
            behavior of the neural network.</p>
            <br>
            <p>Broadly speaking, training the neural network consists of series of forwards and backwards passes through the network.
            With each forward pass through the network, input data is used to make a prediction of rainfall exceedance at the output
            layer of the network. As the data passes through the network, weights within the network as well as biased “activation
            functions” determine the result at the output layer. This prediction is then compared to a ground truth provided by the
            PRISM dataset. The success or failure of the predictions informs the way in which the weights and biases within the
            network are adjusted on the subsequent backwards pass through the network. The process then repeats until the process is
            terminated by a stopping condition (e.g., a fixed number of forward/backward passes have been made or evidence of
            overfitting begins to appear).</p>
            
            <p>The LEARN2 system is composed of two different neural networks combined in a “voting” algorithm. All of which are
            described below.</p>
<br>
            <h3><b style="color:#e0f42b">What are the inputs to the tool?</b></h3>

            <p>Inputs provided to the neural network come in two types: reforecast products and teleconnection products.
            Teleconnections consist of a single number representing the magnitude of the teleconnection index for date from which
            the prediction is being made. Reforecast products come from the GEFS and ECMWF and are one of: 24-hour cumulative rain,
            temperature, IVT, convergence, vorticity, geopotential height. Each of these products are Z-normalized over the training
            data. That is, they are converted such that the mean is removed and then the product is normalized by the standard
            deviation. In the case of 24-hour rain accumulation, we take the cube root before performing the Z-normalization in an
            effort to better approximate a Gaussian distribution. The net result is that all input products are on approximately the
            same scale, improving the functionality of the neural network. Because the GEFS and ECMWF reforecasts are ensemble
            models, we examine the raw values from each ensemble member, as well as the mean and standard deviation for each
            product. For details on which products are selected, the geographic area in which they are used and the predictively
            lookaheads used, refer to the Genetic Algorithm section of this document (below).</p>
<br>
            <h3><b style="color:#e0f42b">What are the output products of the tool?</b></h3>

            <p>The output of the neural network is a one-dimensional vector. Each value in the vector represents a point in our
            prediction grid. In the terminology of classification, we have reduced the problem to a multi-class binary
            classification problem. That is, given a particular set of inputs, we aim to discover to which of the possible classes
            does this input belong (if any). For this problem, each class is “anomalous rainfall at a specified latitude, longitude
            pair.” The ground truth is created by examining each point of interest (a regular grid of points in Washington, Oregon,
            and California) and determining the average and standard deviation of the 24-hour rainfall (removing 0 rain days) at
            that point. A positive case is defined as a specified number of standard deviations (σ) above the mean. LEARN2 has been
            trained using σ values of 0, 0.5, 1, 1.5, and 2. The output of neural network for a given point will fall between 0 and
            1. Numbers closer to 1 indicate a prediction of the positive class (i.e., the network predicts rainfall amounts will
            cross the mean+ σ threshold at that point).</p>
<br>
            <h3><b style="color:#e0f42b">What is the definition of the “F1-score”?</b></h3>

            <p>Rainfall prediction is known to be a difficult problem. One difficulty is that it rains far less than it doesn’t rain.
            Though performing a cube root on the rainfall begins to address this problem, it remains the case that the dataset is
            highly unbalanced. Therefore, simple metrics like accuracy of prediction can distort the reported efficacy of the
            system. To evaluate the LEARN2 system more fairly and compare it against state-of-the-art weather prediction such as
            GEFS and ECMWF, we use the commonly used F1-score. This score attempts to balance “recall” in which the system can
            correctly identify all positive cases with “precision” in which the system attempts to avoid “false alarms.” Expressed
            in terms of true positives (TP), false positives (FP), and false negatives (FN), the F1-score can be computed as:
            
            F_1=TP/(TP+0.5*(FP+FN) )</p>
<br>
            <h3><b style="color:#e0f42b">What is the Dense Network?</b></h3>

            <p>This network is a fully-connected neural network. Each two-dimensional reforecast product input is run independently
            through its own fully-connected, 24-node network, followed by a batch normalization to help prevent over fitting. The
            teleconnection input (if any) is run through a smaller, 3-node dense layer. Subsequently, all independent dense networks
            are flattened and concatenated. The concatenated inputs are run through a another fully-connected, 48-node network with
            a rectified linear activation function. The final layer in the dense network is another fully connected layer with a
            node for each output class. This final layer uses a sigmoid activation function to ensure that all outputs fall in the
            range 0 to 1. This network is a Phase-II refinement on the similar Phase-I network.</p>
<br>
            <h3><b style="color:#e0f42b">What is the Convolutional Network?</b></h3>

            <p>This network uses a convolutional kernel to convolve subsets of the input before passing entering the fully-connection
            portions of the neural network. Up to three products from a given source may be
            
            convolved together to find patterns across products that may be useful in predicting rain. The input to the convolution
            network is a series of three-dimensional sets of reforecast products. The convolution layer for each set of products
            consists of 8 filters with 3x3x3 kernels with a stride of 1 in each dimension. Subsequent to this convolution, the
            network behaves similarly to the dense network. All of the networks are flattened and concatenated (possibly with a
            teleconnection). As in the dense network, the concatenated inputs are run through a fully-connected, 48-node network
            with a rectified linear activation function. Once again, the final layer in the network is a fully-connected layer with
            a node for each output class. This final layer again uses a sigmoid activation function to ensure that all outputs fall
            in the range 0 to 1. Though a convolutional network appeared in the Phase-I system, this configuration in new for the
            second reporting period of the Phase-II system.</p>
<br>
            <h3><b style="color:#e0f42b">How does the Voting Algorithm work?</b></h3>

            <p>Ultimately, LEARN2 provides a binary prediction based on a final “voting” algorithm. This algorithm has been more fully
            explored in this quarter of Phase-II. In this algorithm, the results of the Dense and Convolutional networks (described
            above) are combined with a prediction from the ECMWF ensemble model to provide a final, binary prediction of rain.
            Experiments with the GEFS model were not shown to improve the performance of this model and so are omitted from the
            final algorithm. To combine the Dense, Convolution, and ECMWF model, the three models need to be on the same scale. The
            Dense and Convolutional models each pass through a final sigmoid activation function and are therefore guaranteed to be
            in the range 0 to 1. However, ECMWF provides as continuous, not a binary prediction of rainfall. Further, as an ensemble
            model, it provides multiple predictions. Our solution is to threshold each of the members of the ensemble: 0 indicates
            that the ensemble member predicts rainfall quantities below the threshold while 1 indicates that the ensemble member
            predicts rainfall above the threshold. Averaging the threshold ensemble members then guarantees a number a number
            between 0 and 1 (in essence providing the percentage of ensemble members predicting anomalous rain). We then combine the
            Dense, Convolution, and ECMWF models via an average. The final result is a likelihood of rain, where 0 indicates a
            confident prediction of no rain while 1 indicated very high confidence of rain.</p>

            <p>To compare the voting algorithm against ECMWF, and GEFS, we threshold the predictions made by each of the three systems.
            Although each system tips from more confident in no rain to more confident in rain at 0.5, a plot of precision vs.
            recall indicates that all three system err on the side of caution, maximizing precision at the expensive of recall
            (i.e., ensuring that there are few false alarms while missing heavy rain events). In fact, selecting a likelihood
            threshold of 0.3 provides the best F1 score for each system by capture more heavy rain events at the expensive of some
            false positives. Using 0.3 as a likelihood threshold, we have seen that the LEARN2 system outperforms the GEFS by
            providing 2-3 days more lead time with predictions and the ECMWF by 1-2 days.</p>
<br>
            <h3><b style="color:#e0f42b">What is the Genetic Algorithm and how does it work?</b></h3>

            <p>At the heart of the efficacy of the LEARN2 system are the input parameters to the neural networks. In the Phase-I
            system, these inputs were chosen according to controlled information exclusion experiments to determine the candidate
            reanalysis products for optimum neural network performance. However, in Phase-II, the state space for such explorations
            has grown much larger. In addition to</p>

            <p>TBD</p>
            <!-- End User Guide -->
         </div>
       
            </div>
            <br>
            
        </div>
        </div>
        <div style="padding-bottom: 50%;"></div>
    </div>
    <script src="js/bootstrap.bundle.js"></script>
    
</body>
</html>
